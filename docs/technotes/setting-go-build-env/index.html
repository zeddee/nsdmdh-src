<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="author" content="Zed Tan">
    <title>Setting the Go Build env | NSDMDH</title>
    <link rel="stylesheet" href="/css/main.css" />
    <meta property="og:title" content="Setting the Go Build env" />
  <meta property="og:description" content="In relation to: Scalable Microservices with Kubernetes — Building Containers with Docker: Creating the Image
When building Go binaries for a Linux container in a non-Linux environment, you have to specify a Linux environment when running the build command.
 Run env. BSD command that (1) modifies the runtime environment and then (2) runs a specified utility. Syntax is usually env &lt;ENVIRONMENT VARIABLES&gt; &lt;UTILITY TO RUN -PARAMETERS&gt;
 Specify environment in key=value pairs to match the container environment." />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="http://www.nsdmdh.com/technotes/setting-go-build-env/" />
  
    
        <meta property="og:image" content="http://www.nsdmdh.com/img/colours/goldfish.png" />
    
  
  
  
  
  
  
  
  
  
  
    
        
          
            <meta property="article:tag" content="Technotes" />
          
            <meta property="article:tag" content="Zed" />
          
        
      

  </head>

  <body>
  <header>
<nav class="menu">
  <ul>
    <li><h1 class="mainTitle"><a href="/">NSDMDH</a></h1></li>
    <ul>
    
    
    <li>
      <a href="http://www.nsdmdh.com">home/nsdmdh</a>
    </li>
    
      
      <li>
        <a href="/essays/">essays</a>
      </li>
    
      
      <li>
        <a href="/posts/">posts</a>
      </li>
    
      
      <li>
        <a href="/surfaceintervals/">surfaceintervals</a>
      </li>
    
      
      <li>
        <a href="/technotes/">technotes</a>
      </li>
    
      
      <li>
        <a href="/zedreads/">zedreads</a>
      </li>
    

    
    </ul>
  </ul>
</nav>
</header>


<div class="article-meta">
<h1><span class="title">Setting the Go Build env</span></h1>


</div>

<main>
<p>In relation to: <a href="https://classroom.udacity.com/courses/ud615/lessons/7826816435/concepts/81980819570923#">Scalable Microservices with Kubernetes — Building Containers with Docker: Creating the Image</a></p>

<p>When building Go binaries for a Linux container in a non-Linux environment, you have to specify a Linux environment when running the build command.</p>

<ol>
<li><p>Run <code>env</code>. BSD command that (1) modifies the runtime environment and then (2) runs a specified utility. Syntax is usually <code>env &lt;ENVIRONMENT VARIABLES&gt; &lt;UTILITY TO RUN -PARAMETERS&gt;</code></p></li>

<li><p>Specify environment in key=value pairs to match the container environment. In the case of Alpine Linux Docker images, specify the environment as <code>GOOS=linux GOARCH=386</code>.</p></li>

<li><p>Run the &ldquo;go build&rdquo; utility. In this context, the environment is set such that the utility will build for a Linux i386 environment.</p></li>

<li><p>Attach flags to build with static binaries.
4.1. <code>--tags netgo</code> forces Go to build binaries with the Go network&rsquo;s library instead of the host&rsquo;s libraries.
4.2. <code>--ldflags &quot;-extldflags '-lm -lstdc++ -static'&quot; passes &quot;-extldflags '…'&quot;</code> as arguments for every Go tool link invocation. Arguments are read as a space separated string.
4.3. <code>-extldflags '-lm -lstdc++ -static'</code> builds the Go binary with static libraries. Libraries included are: lm, lstdc++, static(?).</p></li>
</ol>

<p>Complete command:</p>

<pre><code>env GOOS=linux GOARCH=386 go build --tags netgo --ldflags &quot;-extldflags '-lm -lstdc++ -static'&quot;
</code></pre>

</main>

  <footer>
  never say doesn't mean don't have &copy; 2017 | <a href="mailto:zed@nsdmdh.com">zed@nsdmdh.com</a>
  
  </footer>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-7775600-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());

  gtag('config', 'UA-7775600-5');
</script>

  </body>
</html>

